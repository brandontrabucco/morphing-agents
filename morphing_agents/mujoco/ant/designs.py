from morphing_agents.mujoco.ant.elements import LEG
from morphing_agents.mujoco.ant.elements import LEG_UPPER_BOUND
from morphing_agents.mujoco.ant.elements import LEG_LOWER_BOUND
from typing import List, NamedTuple
import numpy as np
import random


DEFAULT_DESIGN = (
    LEG(x=0.0,
        y=0.0,
        z=0.0,
        a=0,
        b=0,
        c=0,
        hip_center=0,
        hip_range=5,
        thigh_center=0,
        thigh_range=30,
        ankle_center=50,
        ankle_range=20,
        hip_size=0.2,
        thigh_size=0.2,
        ankle_size=0.4),
    LEG(x=0.0,
        y=0.0,
        z=0.0,
        a=0,
        b=0,
        c=90,
        hip_center=0,
        hip_range=5,
        thigh_center=0,
        thigh_range=30,
        ankle_center=50,
        ankle_range=20,
        hip_size=0.2,
        thigh_size=0.2,
        ankle_size=0.4),
    LEG(x=0.0,
        y=0.0,
        z=0.0,
        a=0,
        b=0,
        c=180,
        hip_center=0,
        hip_range=5,
        thigh_center=0,
        thigh_range=30,
        ankle_center=50,
        ankle_range=20,
        hip_size=0.2,
        thigh_size=0.2,
        ankle_size=0.4),
    LEG(x=0.0,
        y=0.0,
        z=0.0,
        a=0,
        b=0,
        c=270,
        hip_center=0,
        hip_range=5,
        thigh_center=0,
        thigh_range=30,
        ankle_center=50,
        ankle_range=20,
        hip_size=0.2,
        thigh_size=0.2,
        ankle_size=0.4))


CURATED_DESIGNS = [
    DEFAULT_DESIGN,
    [LEG(x=-0.07686602858431878, y=-0.06873628205681111, z=-0.07131790161436094, a=39.42075599820885,
         b=-144.26270897115714, c=-79.8121613706046, hip_center=-132.51276675068817, hip_range=0.31892530164081334,
         thigh_center=64.80930867122106, thigh_range=15.336447604859506, ankle_center=166.4931130226537,
         ankle_range=40.96353717485677, hip_size=0.23026772558192232, thigh_size=0.3719144452952604,
         ankle_size=0.2386141855243161),
     LEG(x=-0.013805209232138863, y=0.09971104121070981, z=0.05392304204770976, a=135.17646357223884,
         b=-63.548470006992815, c=88.39629854222017, hip_center=83.1019465763747, hip_range=11.44219751702576,
         thigh_center=68.35755263706835, thigh_range=23.064574215568648, ankle_center=-137.17816109796144,
         ankle_range=13.681571402434667, hip_size=0.2834016046755997, thigh_size=0.30862123205212666,
         ankle_size=0.4657982890646314),
     LEG(x=-0.05610848517062566, y=0.0011807418386341473, z=0.08963274959007825, a=130.81838960722035,
         b=-91.80425485480973, c=-122.02619464411836, hip_center=-4.814644082464042, hip_range=12.448201582771215,
         thigh_center=-175.53188887703752, thigh_range=18.412836304942594, ankle_center=156.03260136794728,
         ankle_range=36.527680556212324, hip_size=0.13240502390349715, thigh_size=0.32563387234107477,
         ankle_size=0.5767349027733522),
     LEG(x=-0.056700751272628504, y=-0.053461640173411464, z=0.019375976170082576, a=-99.87993856886116,
         b=-63.36190561304818, c=-94.5451839036547, hip_center=-90.58719974039744, hip_range=12.712057376183884,
         thigh_center=-61.155428550531624, thigh_range=17.66677487143621, ankle_center=16.59850038443176,
         ankle_range=19.327270240029996, hip_size=0.16076717880875457, thigh_size=0.17302340869778216,
         ankle_size=0.23283657686835119)],
    [LEG(x=-0.08821912049281343, y=-0.06933106270622572, z=0.0944453994997298, a=6.255434143137165,
         b=-109.13383288439454, c=-167.35453045786812, hip_center=-120.14648017006999, hip_range=42.62820379674567,
         thigh_center=46.11886761876241, thigh_range=0.44212004920619385, ankle_center=-57.98009624204175,
         ankle_range=23.681384803960214, hip_size=0.22691653754392593, thigh_size=0.18295674632828052,
         ankle_size=0.36631194900510344),
     LEG(x=-0.012431485606449952, y=-0.01054033663973139, z=0.09199074417827152, a=35.74961086937671,
         b=65.56499357391516, c=-16.39792640660474, hip_center=81.05038802105952, hip_range=21.807956368650895,
         thigh_center=93.73376124050253, thigh_range=0.730490646887415, ankle_center=-26.237014411340624,
         ankle_range=37.66024628655455, hip_size=0.35013215404760434, thigh_size=0.30530272770288014,
         ankle_size=0.20388539196581215),
     LEG(x=0.06255197548361732, y=0.06023981578283677, z=-0.023144138724789903, a=-134.0087265320333,
         b=-39.65458022140578, c=-61.0889844703036, hip_center=-156.91743848369146, hip_range=37.90217447486048,
         thigh_center=-99.49414013036512, thigh_range=28.8060921756204, ankle_center=133.95834154288866,
         ankle_range=3.9836750640997542, hip_size=0.2204427601052892, thigh_size=0.3529787050438228,
         ankle_size=0.6995735713256077),
     LEG(x=-0.06051844626586838, y=-0.044180035604136726, z=-0.027742937716273966, a=-139.51079735488304,
         b=23.662530228102924, c=-43.280584767141875, hip_center=-152.7316931617071, hip_range=9.22061151211496,
         thigh_center=126.48616398293132, thigh_range=10.825118821981953, ankle_center=67.55707051232994,
         ankle_range=16.727739609232852, hip_size=0.248324356758822, thigh_size=0.34563931758303956,
         ankle_size=0.2595531394903656)],
    [LEG(x=0.0015607164048763583, y=0.08588579715995173, z=0.09990060739334425, a=-29.99095180501203,
         b=-6.994735413456738, c=-137.1610115983968, hip_center=-168.14650843065354, hip_range=10.158424768279875,
         thigh_center=39.91690425913788, thigh_range=15.961252201837846, ankle_center=104.50647480257487,
         ankle_range=12.3321492360019, hip_size=0.3950946222689289, thigh_size=0.20589507558478826,
         ankle_size=0.5318885485138946),
     LEG(x=0.07203586068374368, y=0.002229425833685128, z=0.08585847852599127, a=31.34731172520864,
         b=-85.46467958769246, c=-131.77971085317668, hip_center=-121.80260008679768, hip_range=16.7051779464078,
         thigh_center=158.42586031354045, thigh_range=33.91703822223463, ankle_center=-83.95967684838314,
         ankle_range=3.2798632678400708, hip_size=0.345838023605727, thigh_size=0.336904620450153,
         ankle_size=0.24009961522589157),
     LEG(x=-0.015505888737905038, y=0.06268447866942395, z=-0.014624260655497046, a=-109.87961710699383,
         b=-139.36695063035106, c=53.798517383811145, hip_center=-132.54946606178356, hip_range=14.832161294290733,
         thigh_center=177.69158869589046, thigh_range=37.67535791547491, ankle_center=-156.80964272567812,
         ankle_range=44.026655919601716, hip_size=0.31254612303228885, thigh_size=0.38245202882232365,
         ankle_size=0.537550693482127),
     LEG(x=0.09389334155536364, y=0.02749939678913771, z=0.025000496251835924, a=-86.85912256926999, b=159.421353062683,
         c=134.17579099890133, hip_center=66.08961609467292, hip_range=18.156009121947083,
         thigh_center=98.93752161984241, thigh_range=5.945946449668975, ankle_center=-139.15579964207348,
         ankle_range=18.46490775204206, hip_size=0.2882658376825652, thigh_size=0.2485093485888785,
         ankle_size=0.31235770608224567)]]


def sample_uniformly(num_legs=4) -> List[NamedTuple]:
    return [LEG(*np.random.uniform(
        low=LEG_LOWER_BOUND, high=LEG_UPPER_BOUND))
        for n in range(num_legs)]


def sample_curated() -> List[NamedTuple]:
    return random.choice(CURATED_DESIGNS)
